import cv2
import os
import xml.etree.cElementTree as ET

rd_path_xml = r'D:\Mammograph\ROI_training_dataset\Annotations-test/'

malignant_list = [1,1,4,4,7,7,14,14,19,19,38,38,40,40,41,41,49,49,54,54,60,60,68,68,70,70,73,73,79,79,98,98,99,99,102,102,107,107,109,109,112,112,124,124,126,126,
                  129,129,136,136,139,139,146,146,158,158,159,159,160,160,162,162,169,169,172,172,173,173,177,177,184,184,186,186,187,187,194,194,200,200,202,202,
                  214,214,216,216,233,233,258,258,262,262,268,268,269,269,273,273,289,289,294,294,295,295,304,304,307,307,315,315,327,327,335,335,337,337,342,342,
                  356,356,379,379,381,381,392,392,393,393,401,401,404,404,409,409,411,411,423,423,425,425,429,429,435,435,437,437,439,439,444,444,447,447,458,
                  458,462,462,463,463,475,475,477,477,481,481,483,483,484,484,485,485,486,486,487,487,488,488,489,489,490,490,491,491,492,492,493,493,494,494,495,
                  495,496,496,497,497,498,498,499,499,500,500,501,501,502,502,505,505,506,506,507,507,509,509,510,510,511,511,515,515,517,517,518,518,519,519,520,
                  520,522,522,525,525,526,526,527,527,529,529,530,530,532,532,533,533,535,535,536,536,537,537,538,538,540,540,541,541,543,543,544,544,545,545,546,
                  546,547,547,548,548,549,549,550,550,551,551,554,554,555,555,556,556,558,558,560,560,561,561,562,562,564,564,566,566,567,567,568,568,569,569,570,
                  570,572,572,573,573,574,574,575,575,576,576,577,577,578,578,579,579,580,580,581,581,582,582,583,583,585,585,586,586,587,587,588,588,590,590,591,
                  591,592,592,593,593,7503,7503,7504,7504,7514,7514]
print(len(malignant_list))

def read_xml(xml_path, xml):
    cls_id = int(xml.split('_')[1])
    tree = ET.parse(xml_path)
    root = tree.getroot()
    for label in root.findall('object/name'):
        if cls_id in malignant_list:
            label.text = 'malignant'
        else:
            label.text = 'benign'
    tree.write(xml_path)

def check(xml_path):

    tree = ET.parse(xml_path)
    root = tree.getroot()
    for label in root.findall('object/name'):
        classid = label.text

    return classid

xmls = os.listdir(rd_path_xml)
mal = 0
ben = 0
for xml in xmls:
    xml_path = rd_path_xml + xml
    read_xml(xml_path, xml)
    classid = check(xml_path)
    if classid == 'malignant':
        mal += 1
    elif classid == 'benign':
        ben += 1
print('mal count: ',mal)
print('ben count: ', ben)